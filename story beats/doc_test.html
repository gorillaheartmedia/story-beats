<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DOCX Test</title>

<!-- Try alternate CDN first -->
<script src="https://unpkg.com/docx@8.2.2/build/index.umd.js"></script>

</head>
<body>
<h1>DOCX.js Test</h1>
<p>If the button works, you'll download a Hello World DOCX file.</p>
<button id="testBtn">Test DOCX Export</button>

<script>
console.log("docx global?", typeof window.docx);

if (!window.docx) {
  alert("docx.js did not load â€” check CDN or network settings.");
} else {
  document.getElementById("testBtn").addEventListener("click", async () => {
    const { Document, Packer, Paragraph } = window.docx;
    const docFile = new Document({
      sections: [{
        children: [ new Paragraph("Hello from docx.js!") ]
      }]
    });
    const blob = await Packer.toBlob(docFile);
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "hello.docx";
    link.click();
  });
}
</script>

</body>
</html>
