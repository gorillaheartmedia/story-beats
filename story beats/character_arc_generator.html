<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Character Arc Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #143575; color: #f4f7ff; margin: 0; padding: 24px; }
    .container { max-width: 900px; margin: 0 auto; background: #1f2a49; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0,0,0,0.4);}
    h1 { text-align: center; font-size: 2em; margin-bottom: 0.3em; }
    h2 { text-align: center; color: #ffd370; margin-bottom: 28px; }
    .arc-section { background: #2b3a60; padding: 20px; margin-bottom: 20px; border-radius: 12px;}
    .arc-label { font-size: 1.13em; color: #ffdc91; font-weight: bold; margin: 0 0 7px 0;}
    textarea { width: 100%; padding: 12px; border-radius: 8px; border: none; resize: vertical; font-family: 'Inter', sans-serif; font-size: 1em;}
    .actions { text-align: center; margin-top: 24px;}
    button { background: #4befff; color: #132752; font-weight: bold; padding: 10px 24px; border: none; border-radius: 8px; cursor: pointer; margin: 0 10px;}
    .readonly { font-size: 1.08em; margin: 0 0 12px 0; color: #fffbe5; }
    @media (max-width: 600px) { .container { padding: 2vw; } .arc-section { padding: 2vw; } }
  </style>
  <script src="project-safety.js"></script>
<script>
  getProjectId().then(projectId => {
    console.log("Current projectId:", projectId);
    if (!projectId) {
      alert("No project selected!");
      window.location.href = "dashboard.html";
    }
  });
</script>

</head>
<body>
  <div class="container">
    <h1>üß≠ Character Arc Generator</h1>
    <h2 id="arcArchetypeName"></h2>

    <!-- Arc fields (edit mode) -->
    <div id="arcEdit">
      <div class="arc-section">
        <div class="arc-label">üå™ Flaw or Core Tension</div>
        <textarea id="arcFlaw" rows="3"></textarea>
      </div>
      <div class="arc-section">
        <div class="arc-label">üå± Growth Path</div>
        <textarea id="arcGrowth" rows="4"></textarea>
      </div>
      <div class="arc-section">
        <div class="arc-label">üî• Climactic Turning Point</div>
        <textarea id="arcClimax" rows="4"></textarea>
      </div>
      <div class="arc-section">
        <div class="arc-label">üåà Resolution</div>
        <textarea id="arcResolution" rows="3"></textarea>
      </div>
      <div class="arc-section">
        <div class="arc-label">üï≥ Shadow Path (If They Fail)</div>
        <textarea id="arcShadow" rows="3"></textarea>
      </div>
      <div class="actions">
        <button onclick="finalizeArc()">‚úÖ Finalize & View</button>
        <button onclick="saveArcNotes()">üíæ Save Draft</button>
        <button onclick="window.location.href='character_profile.html'">üîô Back to Character</button>
      </div>
    </div>

    <!-- Arc fields (final mode) -->
    <div id="arcFinal" style="display:none;">
      <div class="arc-section">
        <div class="arc-label">üå™ Flaw or Core Tension</div>
        <div class="readonly" id="flawRead"></div>
      </div>
      <div class="arc-section">
        <div class="arc-label">üå± Growth Path</div>
        <div class="readonly" id="growthRead"></div>
      </div>
      <div class="arc-section">
        <div class="arc-label">üî• Climactic Turning Point</div>
        <div class="readonly" id="climaxRead"></div>
      </div>
      <div class="arc-section">
        <div class="arc-label">üåà Resolution</div>
        <div class="readonly" id="resolutionRead"></div>
      </div>
      <div class="arc-section">
        <div class="arc-label">üï≥ Shadow Path (If They Fail)</div>
        <div class="readonly" id="shadowRead"></div>
      </div>
      <div class="actions">
        <button onclick="window.print()">üñ® Print / Export</button>
        <button onclick="editArc()">‚úèÔ∏è Edit</button>
        <button onclick="window.location.href='character_profile.html'">üîô Back to Character</button>
      </div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
const id = parseInt(params.get("id"), 10);
const characters = JSON.parse(localStorage.getItem("characters") || "[]");
const char = characters[id] || {};

    const arcPresets = {
        "The Hero": {
    flaw: "Driven by the need to prove themselves; often takes on too much responsibility and fears showing vulnerability.",
    growth: "Learns that true strength includes accepting help and sharing burdens. Realizes heroism is about service, not glory.",
    climax: "Faces a crisis where they must trust others or risk failure by going alone.",
    resolution: "Emerges as a respected leader who inspires by example and humility.",
    shadow: "Becomes isolated, burned out, or develops a martyr complex‚Äîsacrificing themselves needlessly."
  },
  "The Sage": {
    flaw: "Detached, overly analytical, sometimes paralyzed by overthinking or afraid to take action.",
    growth: "Learns the value of lived experience and taking risks. Accepts that not all answers can be found in theory or books.",
    climax: "Must make a critical choice without having all the information‚Äîtrusting intuition or others.",
    resolution: "Emerges as a guide who balances wisdom with empathy and timely action.",
    shadow: "Retreats into isolation, hoarding knowledge, or becomes cold and irrelevant to others."
  },
    "The Rebel": {
    flaw: "Defiant and uncompromising, often alienates others by rejecting authority or rules, sometimes rebels even when it‚Äôs self-defeating.",
    growth: "Learns to focus their drive for change on meaningful causes and collaborate without losing their identity.",
    climax: "Confronted with a situation where only unity or compromise can succeed‚Äîmust choose to build bridges, not just burn them.",
    resolution: "Emerges as a visionary reformer, able to inspire others and channel rebellion toward positive transformation.",
    shadow: "Becomes destructive, isolated, or a perpetual outsider, sabotaging both themselves and movements they care about."
  },
    "The Caregiver": {
    flaw: "Self-sacrificing to a fault; neglects their own needs, may become resentful or lose their sense of self.",
    growth: "Learns to set healthy boundaries and recognize that self-care enables better care for others.",
    climax: "Must make a choice that risks disappointing someone to protect their own well-being or values.",
    resolution: "Becomes a compassionate nurturer who supports others without losing themselves‚Äîmodels healthy giving.",
    shadow: "Becomes an enabler or a martyr, trapped in cycles of exhaustion or bitterness."
  },
    "The Ruler": {
    flaw: "Obsessed with control, struggles with delegating or adapting; may become rigid, authoritarian, or disconnected from those they lead.",
    growth: "Learns that true authority comes from trust, collaboration, and flexibility rather than force or fear.",
    climax: "Faces a crisis where they must let go of control and empower others or risk losing everything they‚Äôve built.",
    resolution: "Emerges as a wise and respected leader, trusted by followers and able to adapt to change.",
    shadow: "Becomes a tyrant or figurehead, isolated and resented, their legacy ultimately undermined by their own rigidity."
  },
   "The Lover": {
    flaw: "Overly dependent on connection, fears abandonment or rejection, may lose themselves in relationships or pursue love at any cost.",
    growth: "Learns that true love begins with self-acceptance and authenticity, and that healthy relationships require balance and trust.",
    climax: "Must choose between betraying their own values for love, or risking heartbreak to stay true to themselves.",
    resolution: "Emerges as a fulfilled partner who brings warmth and connection without sacrificing identity.",
    shadow: "Becomes clingy, jealous, or lost in obsession‚Äîrepeating cycles of heartbreak or unrequited longing."
  },
  "The Trickster": {
    flaw: "Disruptive, unreliable, or manipulative; uses humor, cunning, or mischief to deflect responsibility or avoid vulnerability.",
    growth: "Learns that wit and subversion can be a force for truth and healing, not just chaos or avoidance.",
    climax: "Must take responsibility for their actions‚Äîchoosing to reveal a crucial truth or use their cunning for a cause greater than themselves.",
    resolution: "Emerges as a wise fool or agent of change, using their gifts to help others or challenge corruption.",
    shadow: "Becomes an outcast or pariah, forever distrusted and disconnected, sowing discord for its own sake."
  },
    "The Innocent": {
    flaw: "Naive, overly trusting, and ill-prepared for deception or cruelty; may deny reality or retreat into fantasy when faced with hardship.",
    growth: "Learns to see the world‚Äôs complexity without losing hope, developing resilience and gentle wisdom.",
    climax: "Confronted with betrayal, loss, or darkness‚Äîmust act with courage and faith, rather than retreat or surrender.",
    resolution: "Emerges as a quiet source of hope, able to inspire others through optimism and kindness.",
    shadow: "Becomes passive, escapist, or disconnected, unable to cope with reality or help themselves or others."
  },
    "The Explorer": {
    flaw: "Restless, commitment-averse, and unable to settle; may run from problems or avoid roots and responsibility.",
    growth: "Learns that meaning and fulfillment can come from relationships and depth, not just novelty or movement.",
    climax: "Faces a crossroads where they must choose between running away or staying to face a challenge and build something lasting.",
    resolution: "Emerges as a grounded adventurer who brings curiosity and openness to both new and familiar worlds.",
    shadow: "Remains perpetually adrift, missing out on deep bonds or lasting impact, lost in endless wandering."
  },
    "The Orphan": {
    flaw: "Haunted by abandonment, mistrustful or cynical, expects disappointment, may self-sabotage or refuse support.",
    growth: "Learns to build trust and community, realizing that vulnerability is necessary for belonging and healing.",
    climax: "Must risk reaching out for help or accepting love, even if it means risking further hurt.",
    resolution: "Emerges as a resilient survivor, able to form genuine connections and help others do the same.",
    shadow: "Withdraws into isolation or bitterness, repeating patterns of loss and loneliness."
  },
    "The Creator": {
    flaw: "Perfectionist, lost in ideals or imagination; struggles with practical limits, may isolate or fear criticism.",
    growth: "Learns that sharing imperfect work and collaborating brings ideas to life; embraces feedback and imperfection as part of creation.",
    climax: "Must risk releasing their creation into the world or accepting help to finish a vision.",
    resolution: "Emerges as a fulfilled innovator who finds meaning in the act of making, not just in the finished product.",
    shadow: "Stays trapped in unfinished dreams or solitary work, becoming bitter or irrelevant."
  },
    "The Warrior": {
    flaw: "Rigid, stubborn, or emotionally repressed; may solve every problem through conflict or refuse to accept peace.",
    growth: "Learns that true strength includes vulnerability, mercy, and fighting for meaning‚Äînot just for victory.",
    climax: "Must choose between blind loyalty to a cause or discovering a deeper personal code.",
    resolution: "Emerges as a champion of justice, able to defend with both strength and wisdom.",
    shadow: "Becomes ruthless or lost in violence, a weapon for others with no inner compass."
  },
    "The Magician": {
    flaw: "Manipulative, secretive, or obsessed with power or control; may isolate themselves, fearing others will not understand or accept their vision.",
    growth: "Learns that true transformation involves letting others in, sharing knowledge, and using power for collective good.",
    climax: "Must decide whether to risk vulnerability and trust others with their secrets, or wield power alone.",
    resolution: "Emerges as a wise visionary who guides transformation in themselves and others, inspiring change beyond their own reach.",
    shadow: "Becomes a tyrant, trickster, or outcast‚Äîlost in delusion or destructive manipulation."
  },
    "The Shadow": {
    flaw: "Driven by repressed pain, fear, or envy; sabotages themselves or others, often acting as an antagonist to their own growth.",
    growth: "Learns to face and integrate their darkness, finding strength and insight in what was once denied or hidden.",
    climax: "Confronts the source of their pain‚Äîmust choose between healing or unleashing destruction.",
    resolution: "Emerges as a whole, self-aware individual, using their experience to help others avoid similar pitfalls.",
    shadow: "Is consumed by negativity or vengeance, becoming a cautionary tale or true villain."
  },
    "The Seeker": {
    flaw: "Perpetually dissatisfied, always searching for meaning or purpose; risks missing what‚Äôs in front of them, can become isolated or lost.",
    growth: "Learns to appreciate the present, finding fulfillment in relationships, community, or the journey itself.",
    climax: "Faces a moment where they must choose to stay and build roots, or chase another distant dream.",
    resolution: "Emerges as a wise pilgrim, able to balance curiosity and longing with gratitude and commitment.",
    shadow: "Becomes an exile‚Äîforever wandering, never finding home, losing touch with self and others."
  },
    "The Jester": {
    flaw: "Hides pain or truth behind jokes, never taken seriously, may undermine important moments or fail to connect deeply.",
    growth: "Learns when to use humor to heal versus when to drop the mask and be real; discovers the courage to be vulnerable.",
    climax: "Faced with a serious crisis, must choose to step up honestly or deflect with another joke.",
    resolution: "Emerges as both a source of joy and wisdom, able to connect deeply while keeping lightness alive.",
    shadow: "Becomes a tragic clown‚Äîlonely, unfulfilled, their wisdom or heart missed beneath a permanent mask."
  },
    "The Champion": {
    flaw: "Craves admiration and connection, may define self-worth through others‚Äô approval or romantic conquest.",
    growth: "Learns that real love and heroism come from inner strength and self-acceptance, not just external validation.",
    climax: "Must choose between risking their reputation for authentic love or clinging to public image.",
    resolution: "Emerges as an inspiring figure who leads with both courage and heart, attracting loyalty through authenticity.",
    shadow: "Becomes a people-pleaser or love-addict, chasing applause or relationships without meaning."
  },
    "The Oracle": {
    flaw: "Overprotective and quietly controlling, hides feelings to keep others safe, may become emotionally exhausted or avoid their own needs.",
    growth: "Learns that honest vulnerability and self-care allow them to truly help others grow, not just shield them from harm.",
    climax: "Must risk sharing a painful truth or personal weakness to guide someone they love.",
    resolution: "Emerges as a compassionate guide whose wisdom is deepened by empathy and self-awareness.",
    shadow: "Retreats into silence or martyrdom, their gifts lost to self-neglect or emotional burnout."
  },
    "The Crusader": {
    flaw: "Overzealous, self-righteous, or reckless; fights for a cause but alienates allies through intensity or inflexibility.",
    growth: "Learns to balance conviction with collaboration, understanding that winning hearts is as important as winning battles.",
    climax: "Must choose whether to unite with others for greater good or pursue victory at any cost.",
    resolution: "Emerges as a passionate leader who inspires lasting change by empowering a community.",
    shadow: "Becomes a fanatic or martyr, consumed by their mission and unable to adapt or trust."
  },
    "The Healer": {
    flaw: "Self-effacing and quietly wise, gives endlessly but neglects personal growth, may become emotionally numb or avoid their own healing.",
    growth: "Learns to balance compassion with self-respect, recognizing their wisdom is most powerful when they nurture themselves as well as others.",
    climax: "Must confront a situation where their own vulnerability is needed as much as their guidance.",
    resolution: "Emerges as a source of hope and strength, teaching by example how to heal and grow together.",
    shadow: "Becomes depleted, emotionally distant, or lost in caretaking at the expense of their own life."
  },
    "The Commander": {
    flaw: "Authoritative, rigid, or domineering; values discipline and order but may suppress dissent or empathy.",
    growth: "Learns to inspire rather than command, understanding that true leadership empowers others instead of controlling them.",
    climax: "Must choose between enforcing their will or listening and adapting to others‚Äô needs in a critical moment.",
    resolution: "Emerges as a respected and flexible leader who wins loyalty through integrity and courage.",
    shadow: "Becomes a tyrant or an enforcer of empty rules, resented and ultimately ineffective."
  },
    "The Dreamer": {
    flaw: "Idealistic to the point of escapism; gets lost in fantasies or creative visions, struggles to ground dreams in reality.",
    growth: "Learns to balance imagination with action, building real connections and pursuing dreams with practical steps.",
    climax: "Must decide whether to chase an unattainable fantasy or commit to nurturing something tangible and lasting.",
    resolution: "Emerges as an inspiring visionary whose love and creativity touch the real world, not just their imagination.",
    shadow: "Retreats into fantasy, becoming isolated or disillusioned, dreams left unfulfilled."
  },
    "The Performer": {
    flaw: "Craves attention and affection, uses charm or antics to avoid vulnerability, may struggle to form genuine connections.",
    growth: "Learns that true fulfillment comes from authenticity and honest relationships, not just applause or laughter.",
    climax: "Must risk revealing their true self or feelings to someone important, even if it means losing the crowd.",
    resolution: "Emerges as a magnetic, open-hearted individual who inspires others through both joy and sincerity.",
    shadow: "Becomes a hollow entertainer‚Äîloved by many, truly known by none."
  },
    "The Muse": {
    flaw: "Idealizes others or romance, easily disappointed, may be overly passive or dependent on being cherished.",
    growth: "Learns that inspiration and love are reciprocal‚Äîembracing agency and confidence in their own gifts.",
    climax: "Must take initiative to pursue their own dreams or express love, instead of waiting for someone else to act.",
    resolution: "Emerges as a radiant presence who uplifts others while honoring their own worth and desires.",
    shadow: "Remains passive and overlooked, inspiration fading as they neglect themselves."
  },
    "The Watcher": {
    flaw: "Passive observer, reluctant to act or commit, risks missing opportunities or failing to influence events.",
    growth: "Learns that curiosity and hope can inspire action; finds courage to step out of observation and into participation.",
    climax: "Must make a choice to intervene or remain a bystander in a moment of truth.",
    resolution: "Emerges as a gentle catalyst, able to shape change through presence and example.",
    shadow: "Remains forever on the sidelines, regretful, life shaped by others‚Äô decisions."
  },
    "The Hermit": {
    flaw: "Deeply wounded, mistrustful, withdrawn; hides from life to avoid more pain, may become stuck in bitterness or regret.",
    growth: "Learns that healing comes from risking new connections and facing the darkness within.",
    climax: "Must choose whether to reach out or remain isolated when others need them‚Äîor when offered a chance at redemption.",
    resolution: "Emerges as a wise, resilient survivor who finds meaning in vulnerability and authentic belonging.",
    shadow: "Retreats completely from the world, lost in solitude, resentment, or despair."
  },
    "The Archivist": {
    flaw: "Obsessed with preserving knowledge, beauty, or tradition; risks becoming stagnant, isolated, or fearful of change.",
    growth: "Learns that sharing and adapting what they value brings new life and keeps wisdom relevant.",
    climax: "Must decide whether to protect the past at all costs or allow it to evolve for the future.",
    resolution: "Emerges as a guardian and sharer of knowledge who inspires growth while honoring legacy.",
    shadow: "Becomes a relic, hoarding treasures or stories that fade into irrelevance."
  },
  "The Enforcer": {
    flaw: "Overly rigid or controlling, sees rules as unbreakable, may suppress dissent or nuance in the name of order.",
    growth: "Learns to weigh justice with compassion, adapting rules for the greater good, and listening to different perspectives.",
    climax: "Faces a dilemma where strict adherence to law will cause harm‚Äîmust decide whether to bend or break the rules for what is right.",
    resolution: "Emerges as a principled but flexible authority, respected for fairness as well as discipline.",
    shadow: "Becomes a feared or resented tyrant, losing sight of purpose behind the rules."
  },
  "The Herald": {
    flaw: "Obsessed with delivering truth or prophecy, may become dogmatic, disconnected, or ignore the emotional needs of others.",
    growth: "Learns that insight is most powerful when delivered with compassion, context, and timing.",
    climax: "Must decide whether to share a difficult revelation that could hurt others or find a way to guide with care.",
    resolution: "Emerges as a respected guide or messenger, trusted for wisdom and emotional intelligence.",
    shadow: "Becomes a doomsayer or manipulator, feared or dismissed, their message lost in rigidity or cruelty."
  },
    "The Tactician": {
    flaw: "Calculating, wary, or burdened by doubt; struggles to trust others or themselves, may justify questionable means for heroic ends.",
    growth: "Learns that integrity and transparency build true strength; accepts their flaws and opens up to support.",
    climax: "Must decide whether to resort to manipulation to win or risk vulnerability and honesty.",
    resolution: "Emerges as a strategist who leads with both intellect and heart, respected for both cunning and honor.",
    shadow: "Becomes a lone operator, consumed by paranoia or guilt, unable to fully trust or be trusted."
  },
    "The Seeker": {
    flaw: "Restless and always questing, never satisfied with the present; risks missing meaningful relationships or home by chasing distant dreams.",
    growth: "Learns to find wonder and purpose in the here-and-now, blending adventure with appreciation for what‚Äôs close.",
    climax: "Must decide whether to pursue a new horizon or commit to building something lasting with others.",
    resolution: "Emerges as a grounded wanderer‚Äîable to quest outwardly and inwardly without losing their roots.",
    shadow: "Becomes a drifter, forever seeking, never belonging, haunted by what could have been."
  },
    "The Trickster": {
    flaw: "Irreverent and disruptive, may undermine or mock authority even when it‚Äôs self-defeating; struggles with commitment or seriousness.",
    growth: "Learns that subversion can spark positive change when balanced with care and responsibility.",
    climax: "Must decide whether to provoke chaos for its own sake or to use wit and rebellion to stand for something meaningful.",
    resolution: "Emerges as a creative catalyst‚Äîchallenging the status quo with humor and purpose.",
    shadow: "Becomes a destructive prankster or cynical saboteur, leaving only disruption and burned bridges."
  },


};


    const currentCharacter = JSON.parse(localStorage.getItem("currentCharacter")) || {};
    const type = currentCharacter.personalityType || "The Hero";
    document.getElementById("arcArchetypeName").textContent = type;

    const preset = arcPresets[type] || arcPresets["The Hero"];
    const arcNotes = (currentCharacter.arcNotes && currentCharacter.arcNotes.type === type)
      ? currentCharacter.arcNotes
      : preset;

    // Load values in edit mode
    document.getElementById("arcFlaw").value = arcNotes.flaw;
    document.getElementById("arcGrowth").value = arcNotes.growth;
    document.getElementById("arcClimax").value = arcNotes.climax;
    document.getElementById("arcResolution").value = arcNotes.resolution;
    document.getElementById("arcShadow").value = arcNotes.shadow;

    function saveArcNotes() {
      const saved = JSON.parse(localStorage.getItem("currentCharacter")) || {};
      saved.arcNotes = {
        type,
        flaw: document.getElementById("arcFlaw").value,
        growth: document.getElementById("arcGrowth").value,
        climax: document.getElementById("arcClimax").value,
        resolution: document.getElementById("arcResolution").value,
        shadow: document.getElementById("arcShadow").value
      };
      localStorage.setItem("currentCharacter", JSON.stringify(saved));
      alert("‚úÖ Arc notes saved to character profile.");
    }

    function finalizeArc() {
      saveArcNotes();
      // Show pretty print view
      document.getElementById("arcEdit").style.display = "none";
      document.getElementById("arcFinal").style.display = "block";
      document.getElementById("flawRead").textContent = document.getElementById("arcFlaw").value;
      document.getElementById("growthRead").textContent = document.getElementById("arcGrowth").value;
      document.getElementById("climaxRead").textContent = document.getElementById("arcClimax").value;
      document.getElementById("resolutionRead").textContent = document.getElementById("arcResolution").value;
      document.getElementById("shadowRead").textContent = document.getElementById("arcShadow").value;
    }

    function editArc() {
      document.getElementById("arcEdit").style.display = "block";
      document.getElementById("arcFinal").style.display = "none";
    }

    // If the arc is already finalized (optional: store a flag), you could auto-switch to final mode.
  </script>
</body>
</html>
